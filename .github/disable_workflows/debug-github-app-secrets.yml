name: ğŸ” Debug GitHub App Secrets

on:
  workflow_dispatch:

jobs:
  check-secrets:
    runs-on: ubuntu-latest

    steps:
      - name: âœ… Print part of TANUKI_APP_ID
        run: |
          echo "TANUKI_APP_ID (å…ˆé ­3æ¡): ${TANUKI_APP_ID:0:3}..."
        env:
          TANUKI_APP_ID: ${{ secrets.TANUKI_APP_ID }}

      - name: âœ… Check TANUKI_PRIVATE_KEY (.pem)
        run: |
          echo "----- ç§˜å¯†éµ (.pem) ã®æ¤œè¨¼ -----"
          echo "è¡Œæ•°: $(echo \"$TANUKI_PRIVATE_KEY\" | wc -l)"
          echo "å…ˆé ­è¡Œ: $(echo \"$TANUKI_PRIVATE_KEY\" | head -n 1)"
          echo "æœ«å°¾è¡Œ: $(echo \"$TANUKI_PRIVATE_KEY\" | tail -n 1)"
        env:
          TANUKI_PRIVATE_KEY: ${{ secrets.TANUKI_PRIVATE_KEY }}

      - name: âœ… Check presence of both secrets
        run: |
          if [ -z "$TANUKI_APP_ID" ]; then
            echo "âŒ TANUKI_APP_ID is empty"
            exit 1
          fi
          if [ -z "$TANUKI_PRIVATE_KEY" ]; then
            echo "âŒ TANUKI_PRIVATE_KEY is empty"
            exit 1
          fi
          echo "âœ… ä¸¡æ–¹ã®SecretsãŒç¢ºèªã§ãã¾ã—ãŸï¼"
        env:
          TANUKI_APP_ID: ${{ secrets.TANUKI_APP_ID }}
          TANUKI_PRIVATE_KEY: ${{ secrets.TANUKI_PRIVATE_KEY }}
