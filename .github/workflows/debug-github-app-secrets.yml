name: üîç Debug GitHub App Secrets

on:
  workflow_dispatch:

jobs:
  check-secrets:
    runs-on: ubuntu-latest

    steps:
      - name: ‚úÖ Print part of TEST_GITHUB_APP_ID
        run: |
          echo "TEST_GITHUB_APP_ID (ÂÖàÈ†≠3Ê°Å): ${TEST_GITHUB_APP_ID:0:3}..."
        env:
          TEST_GITHUB_APP_ID: ${{ secrets.TEST_GITHUB_APP_ID }}

      - name: ‚úÖ Check TEST_GITHUB_APP_PRIVATE_KEY (.pem)
        run: |
          echo "----- ÁßòÂØÜÈçµ (.pem) „ÅÆÊ§úË®º -----"
          echo "Ë°åÊï∞: $(echo \"$TEST_GITHUB_APP_PRIVATE_KEY\" | wc -l)"
          echo "ÂÖàÈ†≠Ë°å: $(echo \"$TEST_GITHUB_APP_PRIVATE_KEY\" | head -n 1)"
          echo "Êú´Â∞æË°å: $(echo \"$TEST_GITHUB_APP_PRIVATE_KEY\" | tail -n 1)"
        env:
          TEST_GITHUB_APP_PRIVATE_KEY: ${{ secrets.TEST_GITHUB_APP_PRIVATE_KEY }}

      - name: ‚úÖ Check presence of both secrets
        run: |
          if [ -z "$TEST_GITHUB_APP_ID" ]; then
            echo "‚ùå TEST_GITHUB_APP_ID is empty"
            exit 1
          fi
          if [ -z "$TEST_GITHUB_APP_PRIVATE_KEY" ]; then
            echo "‚ùå TEST_GITHUB_APP_PRIVATE_KEY is empty"
            exit 1
          fi
          echo "‚úÖ ‰∏°Êñπ„ÅÆSecrets„ÅåÁ¢∫Ë™ç„Åß„Åç„Åæ„Åó„ÅüÔºÅ"
        env:
          TEST_GITHUB_APP_ID: ${{ secrets.TEST_GITHUB_APP_ID }}
          TEST_GITHUB_APP_PRIVATE_KEY: ${{ secrets.TEST_GITHUB_APP_PRIVATE_KEY }}
